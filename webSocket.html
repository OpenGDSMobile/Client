<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <script src="./js/egovframework/mbl/cmm/jquery-1.11.2.js"></script>
        <script src="./js/openGDSMobile/OGDSM.js"></script>
        <script src="./js/openGDSMobile/OGDSM_webSocket.js"></script>
        <title>webSocket</title>
        <style>
        #container {
                border: 1px #999999 solid;
                padding: 10px;
        }
        p.client {
            border-bottom: 1px aquamarine solid;
        }
        p.server {
            border-bottom: 1px crimson solid;
        }
        input {
            padding: 5px;
            width: 250px;
        }
        button {
            padding: 5px;
        }
        </style>
        <script>
            var ws;
            var addr = "ws://113.198.80.60:8081/ApplicationServer/attr-ws.do";
            function connected(){
                if ("WebSocket" in window) {
                    console.log("webSocket is supported by your browser!");
                    ws = new WebSocket(addr);
                    ws.onopen = function(){
                      //  ws.send('enter User');
                    };
                    ws.onmessage = function (evt) {
                        var received_msg = evt.data;
                        console.log('message is receiced...');
                        var p = document.createElement("p");
                        p.setAttribute("class", "server");
                        p.innerHTML = evt.data;
                        var container = document.getElementById("container");
                        container.appendChild(p);
                    };

                    ws.onclose = function () {
                        console.log('Connection is closed...');
                    };
                } else {
                    alert("websocket Not supported by your Browser!");
                }
            }
            function sended() {
                var input = document.getElementById("message");
                var inputId = document.getElementById("yourid");
                var jsonObj = {};
                jsonObj.userId = inputId.value;
                jsonObj.text = input.value;
                //var p = document.createElement("p");
                //p.setAttribute("class", "client");
                //p.innerHTML = "Me : " + input.value;
                //var container = document.getElementById("container");
                //container.appendChild(p);
                //ws.send(input.value);
                console.log(jsonObj);
                ws.send(JSON.stringify(jsonObj));
                input.value="";
            }
            function closed() {
                ws.close();
            }
        </script>

    </head>
    <body>
        <div id="container">

        </div>
        <input type="text" id="yourid" value="test">
        <button type="button" id="conn" onclick="connected()">connect</button>
        <input type="text" id="message" name="message">
        <button type="button" id="send" onclick="sended()">send</button>
        <button type="button" id="close" onclick="closed()">close</button>
    </body>
</html>
