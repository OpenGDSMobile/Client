<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <script src="./js/egovframework/mbl/cmm/jquery-1.11.2.js"></script>
        <script src="./js/openGDSMobile/OGDSM.js"></script>
        <script src="./js/openGDSMobile/OGDSM_webSocket.js"></script>
        <title>webSocket</title>
        <style>
        #container {
                border: 1px #999999 solid;
                padding: 10px;
        }
        p.client {
            border-bottom: 1px aquamarine solid;
        }
        p.server {
            border-bottom: 1px crimson solid;
        }
        input {
            padding: 5px;
            width: 250px;
        }
        button {
            padding: 5px;
        }
        </style>
        <script>
            var ws = new WebSocket("ws://113.198.80.60:8083/events/");
            function webSocketTest(){
                /*
                var addr = "ws://113.198.80.60:8083/events/";
                var testWebSocket = new OGDSM.webSocket(addr, 'test');
                */
                if ("WebSocket" in window) {
                    console.log("webSocket is supported by your browser!");
                    ws.onopen = function(){
                        ws.send('enter User');
                    };
                    ws.onmessage = function (evt) {
                        var received_msg = evt.data;
                        console.log('message is receiced...');
                        var p = document.createElement("p");
                        p.setAttribute("class", "server");
                        p.innerHTML = evt.data;
                        var container = document.getElementById("container");
                        container.appendChild(p);
                    };

                    ws.onclose = function () {
                        console.log('Connection is closed...');
                    };
                } else {
                    alert("websocket Not supported by your Browser!");
                }
            }
            function send() {
                var input = document.getElementById("message");
                var p = document.createElement("p");
                p.setAttribute("class", "client");
                p.innerHTML = "Me : " + input.value;
                var container = document.getElementById("container");
                container.appendChild(p);
                ws.send(input.value);
                input.value="";

            }
            $(function(){
                webSocketTest();
            });
        </script>

    </head>
    <body>
        <div id="container">

        </div>

        <input type="text" id="message" name="message" onchange="send()">
        <!--<button type="button" id="send" onclick="send()">send</button>-->
    </body>
</html>
