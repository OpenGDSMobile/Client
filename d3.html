<!DOCTYPE html>

<html>
    <head>
    	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="stylesheet" href="./css/egovframework/mbl/cmm/jquery.mobile-1.3.2.css">   <!-- jQuery Mobile -->
        <link rel="stylesheet" href="./css/egovframework/mbl/cmm/EgovMobile-1.3.2.css">      <!-- eGov Mobile -->
        
        <script type="text/javascript" src="./js/egovframework/mbl/cmm/jquery-1.9.1.min.js"></script>      <!-- jQuery -->
        <script type="text/javascript" src="./js/egovframework/mbl/cmm/jquery.mobile-1.3.2.min.js"></script> <!-- jQuery Mobile -->
        <script type="text/javascript" src="./js/egovframework/mbl/cmm/EgovMobile-1.3.2.js"></script>      <!-- eGov Mobile -->
       
        <script type="text/javascript" src="./js/d3/d3.js"></script>      <!-- d3.js  3.5.5-->
        <!--<script type="text/javascript" src="./js/openGDSMobile/d3chart.js"></script>-->
        <script type="text/javascript" src="./js/openGDSMobile/OGDSM.js"></script>
        <script type="text/javascript" src="./js/openGDSMobile/OGDSM_chartVisualization.js"></script>
        <script type="text/javascript" src="./js/openGDSMobile/d3chart.js"></script>

<script src="http://d3js.org/topojson.v1.min.js"></script>
<!-- <script src="http://d3js.org/d3.geo.projection.v0.min.js" > </script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js" > </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-geo-projection/0.2.15/d3.geo.projection.js" > </script>


		<style>
		#d3_chart {
		  font: 10px sans-serif;
		  background-color: #fff3aa;
		  text-align: right;/*
		  padding: 30px;
		  margin-left: 0px;
		  margin-top: 20px;
		  margin-right: 0px;*/
		  color: white;
		  height:450px;
		}
		
		.sido_Busan{
  			fill: #d3dfe4;
  			fill-opacity: .5;
		}
		.sido_Chungcheongbuk-do{
  			fill: #5574a6;
  			fill-opacity: .5;
		}
		.sido_Chungcheongnam-do{
  			fill: #329262;
  			fill-opacity: .5;
		}
		.sido_Daegu{
  			fill: #8b0707;
  			fill-opacity: .5;
		}
		.sido_Daejeon{
  			fill: #e67300;
  			fill-opacity: .5;
		}
		.sido_Gangwon-do{
  			fill: #6633cc;
  			fill-opacity: .5;
		}
		.sido_Gwangju{
  			fill: #aaaa11;
  			fill-opacity: .5;
		}
		.sido_Gyeongsangbuk-do{
  			fill: #22aa99;
  			fill-opacity: .5;
		}
		.sido_Gyeonggi-do{
  			fill: #994499;
  			fill-opacity: .5;
		}
		.sido_Gyeongsangnam-do{
  			fill: #b82e2e;
  			fill-opacity: .5;
		}
		.sido_Incheon{
  			fill: #66aa00;
  			fill-opacity: .5;
		}
		.sido_Jeju-do{
  			fill: #dd4477;
  			fill-opacity: .5;
		}
		.sido_Jeollabuk-do{
  			fill: #ff9900;
  			fill-opacity: .5;
		}
		.sido_Jeollanam-do{
  			fill: #f93c3c;
  			fill-opacity: .5;
		}
		.sido_Sejong-si{
  			fill: #18d06e;
  			fill-opacity: .5;
		}
		.sido_Seoul{
  			fill: #e28bb8;
  			fill-opacity: .5;
		}
		.sido_Ulsan{
  			fill: #e28bb8;
  			fill-opacity: .5;
		}
		
		</style>

        <script>
        	//var serverAddr = "http://113.198.80.60:8081/mobile/PublicDataPortal.do";
            //var serverAddr = "http://113.198.80.60/ApplicationServer/PublicDataPortal.do";
            var serverAddr = "http://localhost:8080/mobile/PublicDataPortal.do";
            var obj = null;

            function dataPortal() {
            	
            	//data.go.kr : 원자력발전소 실시간 주변 방사선량
                var paramData = {};
                paramData['keyValue'] = 'VwIZROE4vwdx%2FffoawR%2F25OtAxTe3OChcBcBsnAQyKdtHfroNv8qRCKb82rEwgyMHvNgRRTIhrTVpO012mVkKA%3D%3D';
                paramData['serviceName'] = "NuclearPowerPlantRealtimeLevelofRadiation";
                paramData['NPP_name'] = "YK"; 
                //NPP is Nuclear Power Plant 
                //WS:월성, KR:고리, YK:한빛, UJ:한울
                
                
                $.ajax({
                	type : 'POST',
                	url : serverAddr,
                	data : JSON.stringify(paramData),
                	contentType : "application/json;charset=UTF-8",
                	dataType : 'json',
                	success : function(msg){
                		var resultData = JSON.parse(msg.data);
                		//console.log(msg);
                		//$('#result').text(JSON.stringify(resultData));
                		
						//var xyData = OGDSM.jsonToArray(resultData, 'value', 'expl');
						

                		//console.log(xyData);
                		//console.log(xyData[0].length);
                		//console.log(xyData[1].length);
                		//console.log(JSON.stringify(resultData));

                        var chartObj = new OGDSM.chartVisualization(resultData, {
                            rootKey : 'row',
                            labelKey : 'expl',
                            valueKey : 'value',
                            min : 0
                        });
                        //chartObj.vBarChart('d3_chart');
                		//chartObj.hBarChart('d3_chart');
                        chartObj.lineChart('d3_chart');
                        //chartObj.areaChart('d3_chart');
                        //chartObj.pieChart('d3_chart');

                	},
                	error : function (e){
                		console.log(e);	
                		$('#result').text(e);
                		
                	}
                });  
            }
            
            
			function dataPortal2() {
            	
            	//data.go.kr : 온실가스배출량 조회 서비스
                var paramData = {};
                paramData['keyValue'] = 'VwIZROE4vwdx%2FffoawR%2F25OtAxTe3OChcBcBsnAQyKdtHfroNv8qRCKb82rEwgyMHvNgRRTIhrTVpO012mVkKA%3D%3D';
                paramData['serviceName'] = "GreenGasEmissionReport";
                paramData['startDate']   = "201411";  //yyyymm 200701 ~ 201412 까지만 데이터 존재, 같은 값 사용 
                paramData['endDate']     = "201411";  //yyyymm 200701 ~ 201412 까지만 데이터 존재, 같은 값 사용 
                
                $.ajax({
                	type : 'POST',
                	url : serverAddr,
                	data : JSON.stringify(paramData),
                	contentType : "application/json;charset=UTF-8",
                	dataType : 'json',
                	success : function(msg){
                		resultData = JSON.parse(msg.data);
                		console.log(msg);
                		//$('#result').text(JSON.stringify(resultData));
                		
                		var xyData = jsonToArray(resultData, 'totEmTco2eq', 'brNm');
                		//vbarChart('d3_chart', xyData, 0.001);
                		lineChart('d3_chart', xyData, 0.001);
                	},
                	error : function (e){
                		console.log(e);	
                		$('#result').text(e);
                	}
                });  
            }
			
			function dataPortal3() {
                var paramData = {};
                paramData['serviceName'] = "ArpltnInforInqireSvc";
                paramData['serviceKey'] = "kCxEhXiTf1qmDBlQFOOmw%2BemcPSxQXn5V5%2Fx8EthoHdbSojIdQvwX%2BHtWFyuJaIco0nUJtu12e%2F9acb7HeRRRA%3D%3D";
                paramData['numOfRows'] = "100";
                paramData['envType'] = "pm10Value";
                paramData['sidoName'] = encodeURIComponent("서울");

                $.ajax({
                	type : 'POST',
                	url : serverAddr,
                	data : JSON.stringify(paramData),
                	contentType : "application/json;charset=UTF-8",
                	dataType : 'json',
                	success : function(msg){
                		resultData = JSON.parse(msg.data);
                		console.log(msg);
                		console.log(resultData);
                		$('#result').text(JSON.stringify(resultData));
                	},
                	error : function (e){
                		console.log(e);
                		$('#result').text(e);
                	}
                });
            }
			
			function dataPortal4() {
                var paramData = {};
                paramData['serviceKey'] = "6473565a72696e7438326262524174";
                paramData['returnType'] = "json";
                paramData['serviceName'] = "TimeAverageAirQuality";
                paramData['amount'] = "1/100";
                paramData['dateTimeValue'] = '201501011100';
                paramData['envType'] = "PM10";
                console.log(paramData);
                $.ajax({
                	type : 'POST',
                	url : serverAddr,
                	data : JSON.stringify(paramData),
                	contentType : "application/json;charset=UTF-8",
                	dataType : 'json',
                	success : function(msg){
                		resultData = JSON.parse(msg.data);
                		console.log(msg);
                		console.log(resultData);
                		$('#result').text(JSON.stringify(resultData));
                	},
                	error : function (e){
                		console.log(e);
                		$('#result').text(e);
                	}
                });
            }
			
           // dataPortal5();
            
           $(function(){
        	   
        	   //kMap = function (divId, geodata, center_lat, center_lon, map_scale)
        	   //geodata = ["SIDO", "DONG", "GU"]	
        	   //center_lat, center_lon = Latitude, Longitude
        	   
               var chartObj = new OGDSM.chartVisualization();
               chartObj.kMap('d3_chart', "GU", 34., 131., 3000); 
           }); 
            
        </script>
    </head>
    <body>
    	<div id="result">
    	</div>
    	
    	
    	<div id="d3_chart">
    	</div>
    </body>
</html>
