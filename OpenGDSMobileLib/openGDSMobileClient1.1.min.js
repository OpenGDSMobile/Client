/* 2015-01-29 */ var OGDSM=OGDSM||{};OGDSM=function(){"use strict";return OGDSM.prototype={constructor:OGDSM,version:"1.0"},OGDSM}(window,jQuery),OGDSM.namesapce=function(a){"use strict";var b,c=a.split("."),d=OGDSM;for("OGDSM"===d[0]&&(c=c.slice(1)),b=0;b<c.length;b+=1)"undefined"==typeof d[c[b]]&&(d[c[b]]={}),d=d[c[b]];return d},OGDSM.jsonToArray=function(a,b,c){"use strict";var d=[],e=a.row;return d[0]=[],d[1]=[],$.each(e,function(a){d[0].push(e[a][b]),d[1].push(e[a][c])}),d},OGDSM.namesapce("visualization"),function(a,b){"use strict";var c;return b.visualization=function(a){c=a},b.visualization.prototype={constructor:b.olMap,version:"1.0",getMap:function(){return c},layerCheck:function(a){var b,c=this.getMap().getLayers().getArray();for(b=0;b<c.length;b+=1)if(c[b].get("title")===a)return c[b];return!1}},b.visualization}(ol,OGDSM),OGDSM.visualization.prototype.changeBaseMap=function(a){"use strict";var b,c=this.getMap(),d=c.getLayers();d.forEach(function(a){var b=a.get("title");"basemap"===b&&c.removeLayer(a)}),"OSM"===a?b=new ol.source.OSM:"VWorld"===a?b=new ol.source.XYZ({url:"http://xdworld.vworld.kr:8080/2d/Base/201310/{z}/{x}/{y}.png"}):console.log("Not Map Style"),c.addLayer(new ol.layer.Tile({title:"basemap",source:b}))},OGDSM.visualization.prototype.addMap=function(a){"use strict";var b=this.layerCheck(a.get("title"));null!==b&&this.getMap().removeLayer(b),this.getMap().addLayer(a)},OGDSM.visualization.prototype.removeMap=function(a){"use strict";var b=this.layerCheck(a);this.getMap().removeLayer(b)},OGDSM.visualization.prototype.changeWFSStyle=function(a,b,c,d,e,f){"use strict";b="undefined"!=typeof b?b:null,c="undefined"!=typeof c?c:.5,d="undefined"!=typeof d?d:null,e="undefined"!=typeof d?e:null,f="undefined"!=typeof d?f:null;var g=this.layerCheck(a),h={};return g===!1?-1:(g.setStyle(function(a,c){var g,i,j="#FFFFFF",k=5e3>c?a.get(d):"";if(!h[k]){if(Array.isArray(b)){for(g=0;g<f[1].length;g+=1)if(k===f[1][g])for(i=0;i<e.length;i+=1)if(f[0][g]<=e[i]){j=b[i];break}}else j=b;h[k]=[new ol.style.Style({fill:new ol.style.Fill({color:j}),stroke:new ol.style.Stroke({color:"#00000",width:1}),text:new ol.style.Text({font:"9px Calibri,sans-serif",text:k,fill:new ol.style.Fill({color:"#000000"})})})]}return h[k]}),void g.setOpacity(c))},OGDSM.visualization.prototype.barChart=function(a,b,c,d){"use strict";c="undefined"!=typeof c?c:[],d="undefined"!=typeof d?d:["#000000"];var e=18,f=0,g=$("#"+a),h=d3.max(b[0]),i=null,j=null,k=null;g.empty(),i=d3.select("#"+a).append("svg").attr("id","barchart").attr("width",g.width()).attr("height",e*b[0].length),j=d3.scale.linear().domain([0,h]).range([0,g.width()-50]),i.selectAll("rect").data(b[0]).enter().append("rect").attr("x",0).attr("y",function(a,b){return b*e}).attr("width",function(a){return"-"===a||"0"===a?j(20):j(a)-f}).attr("height",e-2).attr("fill",function(a,e){if("-"===a||"0"===a)return"#AAAAAA";if(0!==c.length)for(k=0;k<c.length;k+=1)if(b[0][e]<=c[k])return d[k];return d[d.length]}),i.selectAll("g").data(b[1]).enter().append("text").attr("x",0).attr("y",function(a,b){return b*e+e-5}).attr("font-weight","bold").attr("font-size","0.8em").text(function(a){return a}),i.selectAll("g").data(b[0]).enter().append("text").attr("x",function(a){return"-"===a||"0"===a?j(10):j(a)-f}).attr("y",function(a,b){return b*e+e-5}).attr("dy",".15em").attr("fill","black").attr("font-size","0.8em").attr("font-weight","bold").text(function(a){return"-"===a||"0"===a?"점검중":a})};